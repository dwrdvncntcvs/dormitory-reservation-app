<link
  href="https://fonts.googleapis.com/css2?family=Poppins&display=swap"
  rel="stylesheet"
/>
<app-header></app-header>

<ion-content>
  <div
    class="deleteDormProfileImageContainer"
    *ngIf="deleteDormProfileToggle == true"
  >
    <div class="question-container">
      <p class="custom-layout">
        Are you sure you want to delete your Dormitory Banner?
      </p>
    </div>
    <div class="button-group-container">
      <ion-button
        color="danger"
        (click)="deleteDormitoryProfileImageAction((dormitoryData)?.id, (dormitoryProfileImage)?.id)"
        >Yes</ion-button
      >
      <ion-button color="medium" (click)="openDeleteDormProfileImageToggle()"
        >No</ion-button
      >
    </div>
  </div>
  <ion-refresher
    (ionRefresh)="doRefresh($event)"
    slot="fixed"
    pullFactor="0.5"
    pullMin="100"
    pullMax="200"
  >
    <ion-refresher-content></ion-refresher-content>
  </ion-refresher>

  <!--Image and location Section-->
  <div class="main-container">
    <div class="image-panel">
      <div class="first">
        <ion-icon name="star"></ion-icon>
        <span class="rate custom-layout">4.5 Ratings</span>
        <span
          ><a class="place custom-layout" href=""
            >{{(dormitoryData)?.address}}</a
          ></span
        >
        <ion-button
          class="activate-button"
          *ngIf="dormitoryStatus === false && userRole === 'owner'"
          (click)="dormitorySwitchAction(dormitoryStatus, dormitoryData.id)"
          color="danger"
          >{{currentDormitoryStatus}}</ion-button
        >
        <ion-button
          *ngIf="dormitoryStatus === true && userRole === 'owner'"
          class="activate-button"
          (click)="dormitorySwitchAction(dormitoryStatus, dormitoryData.id)"
          color="success"
        >
          {{currentDormitoryStatus}}
        </ion-button>
      </div>
      <div class="image-section">
        <ion-fab class="back-fab-btn">
          <ion-fab-button
            color="danger"
            class="arrow-float-btn"
            (click)="goBackToHome()"
          >
            <ion-icon name="arrow-back"></ion-icon>
          </ion-fab-button>
        </ion-fab>
        <div class="profile-thumb">
          <ion-fab
            class="fab-panel"
            *ngIf="userRole === 'owner' && dormitoryProfileImage !== null"
          >
            <ion-fab-button
              color="danger"
              class="edit-float"
              (click)="openDeleteDormProfileImageToggle()"
            >
              <ion-icon
                name="trash"
                *ngIf="deleteDormProfileToggle == false"
              ></ion-icon>
              <ion-icon
                name="close"
                *ngIf="deleteDormProfileToggle == true"
              ></ion-icon>
            </ion-fab-button>
          </ion-fab>
          <img
            *ngIf="dormitoryProfileImage === null"
            src="/assets/images/20503de4f96ace6f1ff06e61a4540c13.png"
          />
          <img
            *ngIf="dormitoryProfileImage"
            [src]="url + '/image/dormitoryProfileImage/' + dormitoryProfileImage.filename"
          />
        </div>
      </div>
    </div>

    <div class="left-panel">
      <div class="left-container">
        <div class="left-content">
          <ion-list>
            <ion-item class="ion-no-padding">
              <div class="dorm-item">
                <h3 class="custom-layout">
                  {{(dormitoryData)?.name}}
                  <ion-icon
                    name="checkmark-circle"
                    *ngIf="((dormitoryData)?.isVerified === true )"
                  ></ion-icon>
                </h3>
                <p class="custom-layout">
                  Current Status:<span>{{currentDormitoryStatus}}</span>
                </p>
                <p class="custom-layout">
                  Owner: <span>{{(userData)?.name}}</span>
                </p>
              </div>
            </ion-item>
            <!--display of room of tenant-->
            <ion-item class="ion-no-padding">
              <div class="item-images custom-layout">
                <h3 class="custom-layout">Room</h3>
                <div class="room-top-btn">
                  <ion-fab
                    horizontal="end"
                    vertical="top"
                    slot="fixed"
                    [hidden]="roomsData.length === 0"
                  >
                    <ion-fab-button
                      class="floating-btn"
                      color="transparent"
                      *ngIf="userRole === 'owner'"
                    >
                      <ion-icon
                        class="floating-icon"
                        size="large"
                        md="ellipsis-horizontal-circle"
                        ios="chevron-back-circle-outline"
                      ></ion-icon>
                    </ion-fab-button>
                    <ion-fab-list side="start" *ngIf="userRole === 'owner'">
                      <ion-fab-button
                        color="light"
                        (click)="openDeleteRoomToggle()"
                      >
                        <ion-icon name="trash"></ion-icon>
                      </ion-fab-button>
                      <ion-fab-button color="light">
                        <ion-icon name="create"></ion-icon>
                      </ion-fab-button>
                    </ion-fab-list>
                  </ion-fab>
                </div>
                <p class="custom-layout" *ngIf="roomsData.length === 0">
                  No Room available
                </p>
                <div class="room" *ngIf="roomsData.length !== 0">
                  <ion-slides
                    [options]="sliderOpts"
                    class="room-slides"
                    (ionSlideDidChange)="slideChanged(slides)"
                  >
                    <ion-slide *ngFor="let room of roomsData">
                      <div class="card">
                        <div
                          class="detail-container"
                          *ngIf="deleteRoomToggle === false"
                        >
                          <h1 class="room-text">{{room.name}}</h1>
                          <p class="room-text">
                            Current Room Status: {{room.activeTenant}} tenants
                          </p>
                          <p class="room-text">
                            Room Capacity: {{room.capacity}} person
                          </p>
                          <p class="room-text">Cost: {{room.roomCost}}</p>
                          <p class="room-text">
                            Electricity Bill: {{room.electricBill}}
                          </p>
                          <p class="room-text">
                            Water Bill: {{room.waterBill}}
                          </p>
                        </div>
                        <div
                          class="deleteRoomContainer"
                          *ngIf="deleteRoomToggle === true"
                        >
                          <div class="close-button-container">
                            <ion-icon
                              class="close-button"
                              color="danger"
                              name="close-outline"
                              (click)="openDeleteRoomToggle()"
                            ></ion-icon>
                          </div>
                          <div class="question-container">
                            <h6 class="question-text custom-layout">
                              Are you sure you want ot delete "{{room.name}}"?
                            </h6>
                          </div>
                          <div class="button-group-container">
                            <ion-button
                              color="danger"
                              (click)="deleteRoomAction((dormitoryData)?.id, room.id)"
                              >Yes</ion-button
                            >
                            <ion-button
                              color="medium"
                              (click)="openDeleteRoomToggle()"
                              >No</ion-button
                            >
                          </div>
                        </div>
                        <ion-button
                          class="reservation-btn custom-layout"
                          *ngIf="userRole === 'tenant' || userRole === null"
                          [disabled]="userRole === null"
                          >Reserve
                        </ion-button>
                      </div>
                    </ion-slide>
                  </ion-slides>
                </div>
              </div>
            </ion-item>
            <!--Amenities section-->
            <ion-item class="ion-no-padding">
              <div class="amenities">
                <h3 class="custom-layout">What this place offers</h3>
                <p class="custom-layout" *ngIf="amenitiesData.length === 0">
                  No amenity available
                </p>
                <div class="amenity" *ngFor="let amenity of amenitiesData">
                  <!-- <ion-icon name="tv-outline"></ion-icon> -->
                  <p class="amenity-text custom-layout">{{amenity.name}}</p>
                </div>
              </div>
            </ion-item>
            <!--More image of the dorm section-->
            <ion-item class="ion-no-padding">
              <div class="item-images">
                <h3 class="custom-layout">More images</h3>
                <ion-slides [options]="sliderOpts" class="preview-slides">
                  <p class="custom-layout" *ngIf="dormImagesData.length === 0">
                    No Images available
                  </p>
                  <ion-slide *ngFor="let dormImage of dormImagesData">
                    <ion-fab
                      *ngIf="userRole === 'owner'"
                      class="more-image-fab"
                      vertical="top"
                      horizontal="end"
                      slot="fixed"
                    >
                      <ion-fab-button
                        *ngIf="userRole === 'owner'"
                        color="danger"
                        class="edit-float"
                      >
                        <ion-icon name="trash"> </ion-icon>
                      </ion-fab-button>
                    </ion-fab>
                    <img
                      [src]="url + '/image/dormImage/' + dormImage.filename"
                      tappable
                      (click)="openPreview(dormImage.filename, 'dormImage')"
                    />
                  </ion-slide>
                </ion-slides>
              </div>
            </ion-item>
            <!--Map Section-->
            <ion-item class="ion-no-padding">
              <h3 class="header custom-layout">Where you'll be</h3>
              <div class="maps">
                <div class="google-maps" id="map2"></div>
              </div>
            </ion-item>
          </ion-list>
        </div>
        <!--Right Side panel Owner Manage Section-->
        <div class="right-container">
          <div class="right-panel" *ngIf="userRole === 'owner'">
            <div class="box-content">
              <div class="manage-border">
                <ion-button
                  class="ion-manage-btn"
                  (click)="goToManageDormitory((dormitoryData)?.id, (dormitoryLocationData)?.locationId)"
                  >Manage</ion-button
                >
                <ion-button class="ion-manage-btn">Payment</ion-button>
                <ion-button class="ion-manage-btn">Instruction</ion-button>
              </div>
            </div>
          </div>

          <!--Right Side panel Tenant view Price Section-->
          <div class="right-panel">
            <div
              class="box-content"
              *ngIf="userRole === 'tenant' || userRole === null"
            >
              <div class="price-border">
                <ion-button class="tenant-btn">Instructions</ion-button>
                <ion-button class="tenant-btn">Sample</ion-button>
                <ion-text>
                  Reservation Details Make sure your guests are familiar with
                  the reservation details. Of course, this will include the
                  check-in and out times, the listing’s address, direct contact
                  information, and a receipt for the rental for your guests.
                  Airbnb will handle your receipts and allow you to input this
                  info. Keeping all of these details handy and accessible to
                  travellers will make the check-in and checkout process quick
                  and painless for you and your guests.
                </ion-text>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="question-section">
      <div class="box custom-layout">
        <ion-item class="image-item">
          <img src="./assets/images/questions.svg" />
          <p class="heading">Questions</p>
        </ion-item>

        <div class="questions">
          <details>
            <summary>What you can say about this dormitory?</summary>
            <ion-label></ion-label>
            <ion-input
              size="10"
              type="text"
              placeholder="Enter your Comment"
              required
            >
            </ion-input>
            <ion-button class="post-btn custom-layout">Post Comment</ion-button>
            <div class="prev-comments" *ngFor="let c of comments">
              <div class="single-item custom-layout">
                <div class="profile">
                  <ion-avatar>
                    <img [src]="c.profile" alt="" />
                    <!--img src="/assets/images/profile.svg" alt="" />-->
                  </ion-avatar>
                  <div class="header-content">
                    <h5>{{c.username}}</h5>
                    <p>{{c.email}}</p>
                  </div>
                </div>
                <ion-text>{{c.comment}} </ion-text>
              </div>
            </div>
          </details>
          <details>
            <summary>Question 2 Here</summary>
            <p>Dormitory is a.....................</p>
          </details>
          <details>
            <summary>Question 3 Here</summary>
            <p>Dormitory is a.....................</p>
          </details>
        </div>
      </div>
    </div>
  </div>
</ion-content>
